<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="https://www.thymeleaf.org"
    xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <title>Painel Centro Cirúrgico</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

  <form th:action="@{/logout}" method="post">
    <input type="submit" value="Sign Out" />
</form>

<p>
    <img src="Bandeira_do_Distrito_Federal_Brasil.jpg" height="100px">
    
</p>

<script>
    lsUser = []
    function listAllUser() {

const xhttp = new XMLHttpRequest();
 xhttp.open("GET", `/user/`);
 xhttp.send();
 xhttp.onload = function () {
     lsUser = JSON.parse(this.responseText);
     out = "";
     for (const i in lsUser) {
        // console.log(lsUser[i])
         u = lsUser[i]
         try {
             cor = corStatus(u.status).cor  
             //console.log(fStatus(u.status).cor)
         } catch (error) {

         }

         out += `<tr onclick='activate(${i})'><td>${u.name}</td>
                                              <td style="background-color: ${cor}"> ${u.status}</td>
                                              <td>${u.local}</td>
                                              <td>${u.iniPrevisto}</td>
                                              <td>${u.iniCirurgia}</td>
                                              <td>${u.fimCirurgia}</td>
                                              <td>${u.saidaPrev}</td>
                 </tr>`;
     }
     document.getElementById("tbody").innerHTML = out;
 }
}
          
        function corStatus(status) {
            console.log(status)
            switch (status) {
                case 'Pré Operatório':
                    return {
                        label: 'Pré-Operatório',
                        cor: '#eff307'
                    };
                case 'Sala de Cirurgia':
                    return {
                        label: 'Sala de Cirurgia',
                        cor: '#1648ec'
                    };
                case 'Sala de Recuperacao':
                    return {
                        label: 'Sala de Recuperacao',
                        cor: '#ec1d16'
                    };
                case 'Transferído':
                    return {
                        label: 'Transferído',
                        cor: '#16ec56'
                    };
            }


        }
      
    </script>
 
        </div>
            <div>
            
                <h5> Regional Hospital Taguatinga | Secretaria de Estado de Saúde do Distrito Federal |  </h5>
                    
                    <script type="text/javascript">
                        function time()
                        {
                        today=new Date();
                        h=today.getHours();
                        m=today.getMinutes();
                        s=today.getSeconds();
                        document.getElementById('txt').innerHTML=h+":"+m+":"+s;
                        setTimeout('time()',500);
                        }
                    </script>
                        
                        
                    <div id="txt">15:57:10</div>

                    <span id="dt-hora"></span>         
      
            </div>
            <script>
                var myVar = setInterval(myTimer, 1000);
                function myTimer() {
                    var d = new Date();
                    document.getElementById("dt-hora").innerHTML = d.getDate()+'/'+(d.getMonth()+1)+'/'+d.getFullYear()+' '+ d
                            .toLocaleTimeString();
    
                    var tabela = localStorage.getItem('corpo-tabela');
    
                    document.getElementById("corpo-tabela").innerHTML = tabela;
                }
                documento.myTimer();
            </script>

            <div class="container mt-3">
                <table class="table table-hover" style="cursor: pointer;">
                    <thead class="table-success">
                        <tr>
                            <th width="39%">Nome do Paciente</th>
                            <th width="20%">Status</th>
                            <th width="20%">Local</th>
                            <th width="10%">Início Previsto</th>
                            <th width="10%">Início Cirurgia</th>
                            <th width="10%">Fim da Cirurgia</th>
                            <th width="10%">Saída da Cirurgia</th>
                        </tr>
                    </thead>
                    <tbody id="tbody">
                    </tr></tbody>
                </table>
                
            </div>
        </div>

        <script>listAllUser();</script>
               
    
    </form>

 </body>

</html> 